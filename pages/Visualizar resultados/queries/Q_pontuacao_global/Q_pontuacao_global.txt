SELECT
	id_utilizador,
	ano,		
    ROUND(SUM(user_pontuacao) / NULLIF(SUM(pontuacao_maxima), 0) * 100, 2) AS pontuacao_global_perc,
    CASE
        WHEN ROUND(SUM(user_pontuacao) / NULLIF(SUM(pontuacao_maxima), 0) * 100, 2) < 25 THEN 'Básico'
        WHEN ROUND(SUM(user_pontuacao) / NULLIF(SUM(pontuacao_maxima), 0) * 100, 2) BETWEEN 25 AND 60 THEN 'Intermédio'
        ELSE 'Avançado'
    END AS nivel
FROM alquevasustentavel."v_pontuacao_final"
WHERE id_utilizador={{Select_user.selectedOptionLabel}} AND ano= {{Select_ano.selectedOptionLabel}}  ----selecionar o user
GROUP BY id_utilizador, ano
ORDER BY pontuacao_global_perc DESC;