{
  "gitSyncId": "692f23e7862bc92544420b37_252bf5c0-1393-45ee-8347-e97e1fa11f09",
  "id": "Validação respostas_Qry_filtrosForm",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "\nSELECT\n  -- certificacoes em CSV -> mapeadas para rótulos legíveis\n  array_to_string(\n    ARRAY(\n      SELECT CASE TRIM(val)\n        WHEN 'globalgap' THEN 'GLOBALG.A.P.'\n        WHEN 'grasp'     THEN 'GRASP'\n        WHEN 'spring'    THEN 'SPRING'\n        WHEN 'prodi'     THEN 'PRODí'\n        ELSE INITCAP(REPLACE(TRIM(val), '_', ' '))\n      END\n      FROM unnest(string_to_array(sf.certificacoes, ',')) AS val\n    ),\n    ', '\n  ) AS certificacoes,\n\n  -- sistemas_producao em CSV -> mapeados\n  array_to_string(\n    ARRAY(\n      SELECT CASE TRIM(val)\n        WHEN 'sp_culturas_anuais'       THEN 'Culturas anuais'\n        WHEN 'sp_culturas_permanentes'  THEN 'Culturas permanentes'\n        WHEN 'sp_producao_animal'       THEN 'Produção animal'\n        ELSE INITCAP(REPLACE(TRIM(val), '_', ' '))\n      END\n      FROM unnest(string_to_array(sf.sistemas_producao, ',')) AS val\n    ),\n    ', '\n  ) AS sistemas_producao,\n\n  -- dimensao -> rótulo legível\n  CASE TRIM(sf.dimensao)\n    WHEN 'de_pequena' THEN 'Pequena'\n    WHEN 'de_media'   THEN 'Média'\n    WHEN 'de_grande'  THEN 'Grande'\n    ELSE INITCAP(REPLACE(TRIM(sf.dimensao), '_', ' '))\n  END AS dimensao\n\nFROM selecoes_filtros sf\nWHERE\n  sf.id_utilizador = {{Select_utilizador.selectedOptionValue}}\n  AND sf.ano = {{Select_year.selectedOptionValue}};\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "pg_alquevaustentavel",
      "isAutoGenerated": false,
      "name": "pg_alquevaustentavel",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "Qry_filtrosForm",
    "pageId": "Validação respostas",
    "runBehaviour": "AUTOMATIC",
    "userSetOnLoad": false
  }
}